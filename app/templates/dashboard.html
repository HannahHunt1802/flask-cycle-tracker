<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Dashboard{% endblock %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body>
    <div id="dashboard" class="dashboard">
        <div class="dashboard-background">
            <div class="dashboard-nav">

                <h1>Hello, {{ user.name }}!</h1>
                <button class="log-period-btn">Log Period</button>

                <!--tabs-->
                <div class="tab-container">
                    <a data-target="my-cycle-tab" class="tab">My Cycle</a>
                    <a data-target="calendar-tab" class="tab">Calendar</a>
                    <a data-target="settings-tab" class="tab">My Account</a>
                    <a data-target="logout-tab" class="tab">Log Out</a>

                    <!--invisible logout form-->
                    <form method="POST" action="{{ url_for('main.logout') }}" style="display:none;" id="logout-form" novalidate>
                        {{ logout_form.hidden_tag() }}
                    </form>
                </div>

                <!--next event container-->
                <div class="today-container">
                    <h4 class="small-text">{{ cycle_pred.main_event }}</h4>
                    <h2 class="large-text">{{ cycle_pred.main_text }}</h2>
                    <p class="smallest-text">{{ cycle_pred.secondary_text }}</p>

                    <div class="sun-moon-container">
                        <div class="sun">
                            <img src="{{ url_for('static', filename='assets/Centre.png') }}" alt="Sun Center" class="sun-center">
                            <img src="{{ url_for('static', filename='assets/Rays.png') }}" alt="Rays" class="rays">
                        </div>
                        <div class="moon">
                            <img src="{{ url_for('static', filename='assets/Moon.png') }}" alt="Moon">
                        </div>
                    </div>
                </div>
            </div>

            <!-- tab content-->
            <div id="calendar-tab" class="tab-content">
                <p>This is the calendar.</p>
            </div>

            <!-- SETTINGS TAB (MY ACCOUNT) -->
            <div id="settings-tab" class="tab-content">
                <div class="open-tab-container">

                    <div class="open-tab-inner">
                        <h3>My Account</h3>
                        <form method="POST" action="{{ url_for('main.update_profile') }}" novalidate>
                            {{ update_profile_form.hidden_tag() }}

                            <div class="update_profile_form-group">
                                <label for="name">Name:</label>
                                {{ update_profile_form.name(class="form-control", value=user.name) }}
                            </div>

                            <div class="update_profile_form-group">
                                <label for="email">Email:</label>
                                {{ update_profile_form.email(class="form-control", value=user.email) }}
                            </div>

                            <button type="submit" class="btn btn-primary">Update Profile</button>
                        </form>
                    </div>
                    <hr>

                    <div class="open-tab-inner">
                        <h3>Change Password</h3>
                        <form method="POST" action="{{ url_for('main.change_password') }}">
                            {{ change_password_form.hidden_tag() }}
                            <div class="form-group">
                                <label for="old_password">Current Password:</label>
                                {{ change_password_form.old_password(class="form-control") }}
                            </div>
                            <div class="form-group">
                                <label for="new_password">New Password:</label>
                                {{ change_password_form.new_password(class="form-control") }}
                            </div>
                            <div class="form-group">
                                <label for="confirm_password">Confirm New Password:</label>
                                {{ change_password_form.confirm_password(class="form-control") }}
                            </div>
                            <button type="submit" class="btn btn-primary">Change Password</button>
                        </form>
                    </div>
                    <hr>

                    <div class="open-tab-inner">
                        <h3>Cycle Settings</h3>
                        <form method="POST" action="{{ url_for('main.update_cycle_settings') }}">
                            {{ update_cycle_settings_form.hidden_tag() }}

                            <div class="form-group">
                                <label for="avg_period_length">Average Period Length (days):</label>
                                {{ update_cycle_settings_form.avg_period_length(class="form-control", value=user.avg_period_length) }}
                            </div>

                            <div class="form-group">
                                <label for="avg_cycle_length">Average Cycle Length (days):</label>
                                {{ update_cycle_settings_form.avg_cycle_length(class="form-control", value=user.avg_cycle_length) }}
                            </div>

                            <button type="submit" class="btn btn-primary">Update Cycle Settings</button>
                        </form>
                    </div>
                    <hr>

                    <div class="open-tab-inner">
                        <h3>Danger Zone</h3>
                        <form method="POST" action="{{ url_for('main.delete_account') }}" onsubmit="return confirm('Are you sure you want to delete your account? This action cannot be undone.');">
                            {{ delete_account_form.hidden_tag() }}

                            <p class="danger-zone-warning">
                                Deleting your account is irreversible. All your data will be lost.
                            </p>

                            <button type="submit" class="btn btn-danger">Delete Account</button>
                        </form>
                    </div>
                    <hr>

                </div>
            </div>
        </div>
    </div>
    <!-- js -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>